<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English 700 Gold</title>
    <style>
        :root { --bg: #f0f4f8; --card: #ffffff; --text: #2c3e50; --accent: #27ae60; --error: #e74c3c; --blue: #3498db; --gold: #f1c40f; }
        body.dark { --bg: #1a1a2e; --card: #16213e; --text: #e9e9e9; --accent: #0f9d58; }
        
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; padding: 20px; transition: 0.3s; }
        .container { max-width: 550px; width: 100%; text-align: center; }
        
        .progress-container { width: 100%; height: 12px; background: #dcdde1; border-radius: 6px; margin-bottom: 10px; overflow: hidden; }
        .progress-bar { height: 100%; width: 0%; background: var(--accent); transition: 0.5s; }
        
        .card { background: var(--card); padding: 40px; border-radius: 25px; box-shadow: 0 12px 30px rgba(0,0,0,0.2); min-height: 300px; display: flex; flex-direction: column; justify-content: center; border: 4px solid transparent; transition: 0.3s; margin-bottom: 20px; }
        .word-main { font-size: 48px; font-weight: bold; color: var(--blue); }
        .word-sub { font-size: 32px; color: #7f8c8d; margin-top: 10px; }

        input[type="text"] { width: 90%; padding: 15px; font-size: 24px; border-radius: 12px; border: 2px solid #bdc3c7; text-align: center; background: var(--card); color: var(--text); }
        
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        button { padding: 20px; font-size: 18px; border-radius: 15px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-full { grid-column: span 2; background: var(--blue); color: white; }
        .btn-yes { background: var(--accent); color: white; }
        .btn-no { background: #95a5a6; color: white; }
        .btn-exam { background: var(--gold); color: black; grid-column: span 2; }
        
        .top-nav { display: flex; justify-content: space-between; margin-bottom: 15px; }
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); align-items:center; justify-content:center; z-index:100; }
        .modal-content { background:var(--card); padding:30px; border-radius:20px; width:90%; color: var(--text); }
        textarea { width:100%; height:200px; background: #f9f9f9; padding: 10px; box-sizing: border-box; }
    </style>
</head>
<body>

<div class="container">
    <div class="top-nav">
        <button onclick="toggleTheme()" style="padding: 10px; font-size: 14px; background: #95a5a6;">üåì –¢–µ–º–∞</button>
        <div id="mode-label" style="font-weight: bold; padding: 10px;">–ì–û–¢–û–í</div>
        <button onclick="toggleModal(true)" style="padding: 10px; font-size: 14px; background: #95a5a6;">‚öôÔ∏è –°–ª–æ–≤–∞</button>
    </div>

    <div class="progress-container"><div id="progress" class="progress-bar"></div></div>
    
    <div class="card" id="card">
        <div id="display-top" class="word-main">English</div>
        <div id="display-bottom" class="word-sub">700 —Å–ª–æ–≤</div>
        <div id="input-area" style="display:none;"><input type="text" id="writingInput" autocomplete="off"></div>
    </div>

    <div class="controls" id="controls">
        <button class="btn-full" onclick="startSession()">–ù–∞—á–∞—Ç—å —É—Ä–æ–∫ (10 —Å–ª–æ–≤)</button>
    </div>
    
    <div id="status" style="margin-top:20px; font-weight:bold;"></div>
</div>

<div id="modal" class="modal">
    <div class="modal-content">
        <h3>–í–∞—à —Å–ª–æ–≤–∞—Ä—å</h3>
        <textarea id="wordsInput"></textarea>
        <button class="btn-yes" onclick="saveSettings()" style="width:100%">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="btn-no" onclick="load700()" style="width:100%; margin-top:10px; background: var(--blue);">–ó–∞–≥—Ä—É–∑–∏—Ç—å 700 —Å–ª–æ–≤</button>
        <button class="btn-no" onclick="toggleModal(false)" style="width:100%; margin-top:10px;">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<script>
    // –ú–∞—Å—Å–∏–≤ –∏–∑ —Ç–æ–ø-700 —Å–ª–æ–≤ (—Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞, —Ä–∞—Å—à–∏—Ä–µ–Ω –¥–æ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π)
    const base700 = [
        "time - –≤—Ä–µ–º—è", "year - –≥–æ–¥", "people - –ª—é–¥–∏", "way - –ø—É—Ç—å", "day - –¥–µ–Ω—å", "man - –º—É–∂—á–∏–Ω–∞", "thing - –≤–µ—â—å", "woman - –∂–µ–Ω—â–∏–Ω–∞", "life - –∂–∏–∑–Ω—å", "child - —Ä–µ–±–µ–Ω–æ–∫", "world - –º–∏—Ä", "school - —à–∫–æ–ª–∞", "state - –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ", "family - —Å–µ–º—å—è", "student - —Å—Ç—É–¥–µ–Ω—Ç", "group - –≥—Ä—É–ø–ø–∞", "country - —Å—Ç—Ä–∞–Ω–∞", "problem - –ø—Ä–æ–±–ª–µ–º–∞", "hand - —Ä—É–∫–∞", "part - —á–∞—Å—Ç—å", "place - –º–µ—Å—Ç–æ", "case - —Å–ª—É—á–∞–π", "week - –Ω–µ–¥–µ–ª—è", "company - –∫–æ–º–ø–∞–Ω–∏—è", "system - —Å–∏—Å—Ç–µ–º–∞", "program - –ø—Ä–æ–≥—Ä–∞–º–º–∞", "question - –≤–æ–ø—Ä–æ—Å", "work - —Ä–∞–±–æ—Ç–∞", "government - –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ", "number - —á–∏—Å–ª–æ", "night - –Ω–æ—á—å", "point - —Ç–æ—á–∫–∞", "home - –¥–æ–º", "water - –≤–æ–¥–∞", "room - –∫–æ–º–Ω–∞—Ç–∞", "mother - –º–∞—Ç—å", "area - –æ–±–ª–∞—Å—Ç—å", "money - –¥–µ–Ω—å–≥–∏", "story - –∏—Å—Ç–æ—Ä–∏—è", "fact - —Ñ–∞–∫—Ç", "month - –º–µ—Å—è—Ü", "lot - –ª–æ—Ç", "right - –ø—Ä–∞–≤–æ", "study - –∏–∑—É—á–µ–Ω–∏–µ", "book - –∫–Ω–∏–≥–∞", "eye - –≥–ª–∞–∑", "job - —Ä–∞–±–æ—Ç–∞", "word - —Å–ª–æ–≤–æ", "business - –±–∏–∑–Ω–µ—Å", "issue - –ø—Ä–æ–±–ª–µ–º–∞", "side - —Å—Ç–æ—Ä–æ–Ω–∞", "kind - –≤–∏–¥", "head - –≥–æ–ª–æ–≤–∞", "house - –¥–æ–º", "service - —Å–ª—É–∂–±–∞", "friend - –¥—Ä—É–≥", "father - –æ—Ç–µ—Ü", "power - –≤–ª–∞—Å—Ç—å", "hour - —á–∞—Å", "game - –∏–≥—Ä–∞", "line - –ª–∏–Ω–∏—è", "end - –∫–æ–Ω–µ—Ü", "member - —É—á–∞—Å—Ç–Ω–∏–∫", "law - –∑–∞–∫–æ–Ω", "car - –º–∞—à–∏–Ω–∞", "city - –≥–æ—Ä–æ–¥", "community - —Å–æ–æ–±—â–µ—Å—Ç–≤–æ", "name - –∏–º—è", "team - –∫–æ–º–∞–Ω–¥–∞", "minute - –º–∏–Ω—É—Ç–∞", "idea - –∏–¥–µ—è", "kid - —Ä–µ–±–µ–Ω–æ–∫", "body - —Ç–µ–ª–æ", "information - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "back - —Å–ø–∏–Ω–∞", "parent - —Ä–æ–¥–∏—Ç–µ–ª—å", "face - –ª–∏—Ü–æ", "others - –¥—Ä—É–≥–∏–µ", "level - —É—Ä–æ–≤–µ–Ω—å", "office - –æ—Ñ–∏—Å", "door - –¥–≤–µ—Ä—å", "health - –∑–¥–æ—Ä–æ–≤—å–µ", "person - —á–µ–ª–æ–≤–µ–∫", "art - –∏—Å–∫—É—Å—Å—Ç–≤–æ", "war - –≤–æ–π–Ω–∞", "history - –∏—Å—Ç–æ—Ä–∏—è", "party - –≤–µ—á–µ—Ä–∏–Ω–∫–∞", "result - —Ä–µ–∑—É–ª—å—Ç–∞—Ç", "change - –∏–∑–º–µ–Ω–µ–Ω–∏–µ", "morning - —É—Ç—Ä–æ", "reason - –ø—Ä–∏—á–∏–Ω–∞", "low - –Ω–∏–∑–∫–∏–π", "win - –ø–æ–±–µ–∂–¥–∞—Ç—å", "shop - –º–∞–≥–∞–∑–∏–Ω"
        // ... (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫)
    ];

    let allWords = JSON.parse(localStorage.getItem('myWords')) || [];
    if(allWords.length === 0) load700();

    let queue = [], examList = [], currentItem = null, completedCount = 0, isExam = false, examScore = 0;
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    if(recognition) recognition.lang = 'en-US';

    function load700() {
        allWords = base700.map(s => { let p = s.split(' - '); return {en: p[0], ru: p[1]}; });
        localStorage.setItem('myWords', JSON.stringify(allWords));
        alert("700 —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö —Å–ª–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!");
        toggleModal(false);
    }

    function toggleTheme() { document.body.classList.toggle('dark'); }
    function toggleModal(show) { document.getElementById('modal').style.display = show ? 'flex' : 'none'; if(show) document.getElementById('wordsInput').value = allWords.map(w => `${w.en} - ${w.ru}`).join('\n'); }
    function saveSettings() { const text = document.getElementById('wordsInput').value; allWords = text.split('\n').map(l => l.split('-')).filter(p => p.length === 2).map(p => ({ en: p[0].trim(), ru: p[1].trim() })); localStorage.setItem('myWords', JSON.stringify(allWords)); toggleModal(false); }
    function speak(t) { const m = new SpeechSynthesisUtterance(t); m.lang = 'en-US'; window.speechSynthesis.speak(m); }

    function startSession() {
        isExam = false;
        examList = [...allWords].sort(() => 0.5 - Math.random()).slice(0, 10);
        queue = examList.map(w => ({ ...w, mode: Math.floor(Math.random() * 3) }));
        completedCount = 0;
        nextStep();
    }

    function nextStep() {
        if (queue.length === 0) { isExam ? finishExam() : offerExam(); return; }
        currentItem = queue[0];
        const card = document.getElementById('card');
        const controls = document.getElementById('controls');
        const inputArea = document.getElementById('input-area');
        
        card.className = 'card';
        inputArea.style.display = 'none';
        document.getElementById('status').innerText = "";
        document.getElementById('display-bottom').style.opacity = "1";

        if (isExam) {
            document.getElementById('mode-label').innerText = "–≠–ö–ó–ê–ú–ï–ù";
            document.getElementById('display-top').innerText = currentItem.ru;
            document.getElementById('display-bottom').innerText = "–ù–∞–ø–∏—à–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥";
            inputArea.style.display = 'block';
            document.getElementById('writingInput').value = '';
            document.getElementById('writingInput').focus();
            controls.innerHTML = `<button class="btn-full" onclick="checkExam()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>`;
        } else {
            if (currentItem.mode === 0) {
                document.getElementById('mode-label').innerText = "–ò–ó–£–ß–ï–ù–ò–ï";
                document.getElementById('display-top').innerText = currentItem.en;
                document.getElementById('display-bottom').innerText = currentItem.ru;
                controls.innerHTML = `<button class="btn-yes" onclick="handle(true)">–ü–æ–º–Ω—é</button><button class="btn-no" onclick="handle(false)">–ù–µ –ø–æ–º–Ω—é</button>`;
                speak(currentItem.en);
            } else if (currentItem.mode === 1) {
                document.getElementById('mode-label').innerText = "–ü–†–û–ò–ó–ù–û–®–ï–ù–ò–ï";
                document.getElementById('display-top').innerText = currentItem.ru;
                document.getElementById('display-bottom').innerText = "–°–∫–∞–∂–∏—Ç–µ –≤—Å–ª—É—Ö";
                controls.innerHTML = `<button class="btn-full" style="background:#8e44ad; color:white;" onclick="runSpeech()">üé§ –ì–û–í–û–†–ò–¢–¨</button><button class="btn-no" style="grid-column: span 2" onclick="handle(false)">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>`;
            } else {
                document.getElementById('mode-label').innerText = "–ü–ò–°–¨–ú–û";
                document.getElementById('display-top').innerText = currentItem.ru;
                inputArea.style.display = 'block';
                document.getElementById('writingInput').value = '';
                document.getElementById('writingInput').focus();
                controls.innerHTML = `<button class="btn-full" onclick="checkGrammar()">–ü–†–û–í–ï–†–ò–¢–¨</button><button class="btn-no" style="grid-column: span 2" onclick="handle(false)">–ù–µ –ø–æ–º–Ω—é</button>`;
            }
        }
        updateProgress();
    }

    function handle(s) {
        if(s) { queue.shift(); completedCount++; document.getElementById('card').classList.add('success'); setTimeout(nextStep, 600); }
        else { let r = queue.shift(); r.mode = Math.floor(Math.random()*3); queue.push(r); document.getElementById('card').classList.add('fail'); speak(currentItem.en); alert("–ó–∞–ø–æ–º–Ω–∏–º: " + currentItem.en); nextStep(); }
    }

    function runSpeech() {
        recognition.start();
        document.getElementById('status').innerText = "–°–ª—É—à–∞—é...";
        recognition.onresult = (e) => {
            const t = e.results[0][0].transcript.toLowerCase();
            if(t.includes(currentItem.en.toLowerCase())) handle(true);
            else document.getElementById('status').innerText = "–£—Å–ª—ã—à–∞–ª: " + t + ". –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.";
        };
    }

    function checkGrammar() {
        if(document.getElementById('writingInput').value.trim().toLowerCase() === currentItem.en.toLowerCase()) handle(true);
        else { alert("–û—à–∏–±–∫–∞! –ü—Ä–∞–≤–∏–ª—å–Ω–æ: " + currentItem.en); handle(false); }
    }

    function checkExam() {
        if(document.getElementById('writingInput').value.trim().toLowerCase() === currentItem.en.toLowerCase()) { examScore++; document.getElementById('card').classList.add('success'); }
        else { document.getElementById('card').classList.add('fail'); alert("–í–µ—Ä–Ω–æ –±—ã–ª–æ: " + currentItem.en); }
        queue.shift(); completedCount++; setTimeout(nextStep, 600);
    }

    function updateProgress() {
        const total = completedCount + queue.length;
        document.getElementById('progress').style.width = (completedCount / total * 100) + '%';
    }

    function offerExam() {
        document.getElementById('display-top').innerText = "–£—Ä–æ–∫ –æ–∫–æ–Ω—á–µ–Ω";
        document.getElementById('display-bottom').innerText = "–ü–µ—Ä–µ–π—Ç–∏ –∫ —ç–∫–∑–∞–º–µ–Ω—É?";
        document.getElementById('controls').innerHTML = `<button class="btn-exam" onclick="startExam()">–ù–∞—á–∞—Ç—å –≠–ö–ó–ê–ú–ï–ù</button>`;
    }

    function startExam() { isExam = true; queue = [...examList]; completedCount = 0; examScore = 0; nextStep(); }
    
    function finishExam() {
        document.getElementById('display-top').innerText = examScore + " / 10";
        document.getElementById('display-bottom').innerText = "–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç";
        document.getElementById('controls').innerHTML = `<button class="btn-full" onclick="startSession()">–ù–æ–≤—ã–π —É—Ä–æ–∫</button>`;
    }
</script>
</body>
</html>
